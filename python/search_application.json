{
  "indices": [
    "enterprise_docs"
  ],
  "template": {
    "script": {
      "source": {
        "query": {
          "bool": {
            "should": [
              {
                "semantic": {
                  "field": "semantic_title",
                  "query": "{{query_string}}",
                  "boost": 1.0499999999999998
                }
              },
              {
                "semantic": {
                  "field": "semantic_content",
                  "query": "{{query_string}}",
                  "boost": 0.7
                }
              },
              {
                "semantic": {
                  "field": "semantic_summary",
                  "query": "{{query_string}}",
                  "boost": 0.84
                }
              },
              {
                "multi_match": {
                  "query": "{{query_string}}",
                  "fields": [
                    "title^3",
                    "content^2",
                    "summary^2",
                    "tags^1.5"
                  ],
                  "type": "best_fields",
                  "fuzziness": "AUTO",
                  "boost": 0.30000000000000004
                }
              }
            ],
            "minimum_should_match": 1,
            "filter": [
              {
                "bool": {
                  "should": [
                    {
                      "term": {
                        "department": "{{user_department}}"
                      }
                    }
                  ]
                }
              }
            ]
          }
        },
        "highlight": {
          "fields": {
            "title": {},
            "content": {},
            "summary": {},
            "semantic_title": {},
            "semantic_content": {},
            "semantic_summary": {}
          },
          "pre_tags": [
            "<mark>"
          ],
          "post_tags": [
            "</mark>"
          ]
        },
        "sort": [
          {
            "_score": {
              "order": "desc"
            }
          },
          {
            "ratings.score": {
              "order": "desc",
              "missing": "_last"
            }
          }
        ],
        "size": "{{size}}",
        "from": "{{from}}"
      }
    }
  }
}